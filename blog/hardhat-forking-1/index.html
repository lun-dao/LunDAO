<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="LunDAO RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="LunDAO Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-react-helmet="true">Hardhat mainnet forking：主網分叉 (1) | LunDAO</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://lundao.tech/blog/hardhat-forking-1"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Hardhat mainnet forking：主網分叉 (1) | LunDAO"><meta data-react-helmet="true" name="description" content="如何利用 Hardhat 進行主網分叉"><meta data-react-helmet="true" property="og:description" content="如何利用 Hardhat 進行主網分叉"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-03-23T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/a2468834"><meta data-react-helmet="true" property="article:tag" content="Mainnet Fork,Mainnet Forking,Hardhat,Nomic Labs"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://lundao.tech/blog/hardhat-forking-1"><link data-react-helmet="true" rel="alternate" href="https://lundao.tech/blog/hardhat-forking-1" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://lundao.tech/blog/hardhat-forking-1" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ba61c7d6.css">
<link rel="preload" href="/assets/js/runtime~main.67d47840.js" as="script">
<link rel="preload" href="/assets/js/main.2d5310ba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">LunDAO</b></a><a class="navbar__item navbar__link" href="/docs/publish-guideline">關於</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">文章</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lun-dao/LunDAO" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>DAO<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/end-of-lundao">LunDAO 的結尾</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/crvusd">LLAMMA - crvUSD 的新清算機制</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/diamond101-4">Diamond 101 (4)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/diamond101-2">Diamond 101 (2)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/diamond101-3">Diamond 101 (3)</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Hardhat mainnet forking：主網分叉 (1)</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-03-23T00:00:00.000Z" itemprop="datePublished">March 23, 2022</time> · <!-- -->13 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/a2468834" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/a2468834.png" alt="Chuan-Chun Wang"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/a2468834" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Chuan-Chun Wang</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>本文章將展示怎麼使用知名開發工具 Hardhat 的主網分叉（mainnet forking），令開發者可任意指定欲分叉的區塊鏈高度，並與 Hardhat 內建的自定義 testnet（Hardhat Network）結合，享受最高仿真度、最簡便的開發環境。</p><p>在 Ethereum 開發 Dapp 少不了撰寫智能合約（smart contract）；除了使用 Go Ethereum（Geth）、OpenEthereum 等工具自建一條 local testnet，並將合約部屬在上面之外，還可將合約部屬到各大公開測試網（testnet）<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>。然而，這些方法雖然都使用與主網（mainnet）幾乎相同的<sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>程式碼當作 L1 底層，但是與直接部屬在 mainnet 最大的差異就是：你幾乎無法讓你的 Dapp 與其他知名合約、DEX 做互動。</p><p>DeFi 之所以在近年受到全球矚目，其中一個原因莫過於其高度的互操作性（interoperability）；各個合約之間可以透過程式呼叫，輕鬆地與彼此互動，達成傳統金融所無法企及的巨大靈活能力。</p><p>然而，如果你正在開發的 Dapp/DeFi 專案，無法在極度仿真的環境當中，通過完整的測試即貿然上線，則此服務將暴露於巨大風險之下。</p><p>部屬合約於 (local) testnet 當中，為求最精緻的模擬環境，你將會耗費極大心力逐一複製所有第三方合約、DEX 的程式碼，並重新佈署於模擬環境當中，這完全不是一個可行的方法。</p><p>Hardhat 的說明文件是這麼介紹 mainnet forking：</p><blockquote><p>You can start an instance of Hardhat Network that forks mainnet. <strong>This means that it will simulate having the same state as mainnet</strong>, but it will work as a local development network. <sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup></p></blockquote><p>本文章將帶領各位讀者熟悉 mainnet forking 的使用方法，並在另一篇文章當中舉幾個例子讓讀者能體會 mainnet forking 的方便性，以期各位讀者都能善用此工具。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="背景知識與環境">背景知識與環境<a class="hash-link" href="#背景知識與環境" title="Direct link to heading">​</a></h2><p>Mainnet forking 背後的運作機制，概念上就是模擬一個仿造 Ethereum mainnet 的 local testnet，讓開發者誤以為自己是跟 mainnet 互動。</p><p>當開發者呼叫合約或發送 tx 時，如果該「仿造版」local testnet 查無資訊（該資訊可能是紀錄在某個歷史 block 當中），則 Hardhat 套件轉向歸檔節點（archive node）詢問資訊的內容，並將回傳的結果經過適當包裝後丟給開發者。因此，開發者必需主動提供兩個條件：(1) archive node (2) 指定的區塊高度（以此高度為基準劃分出何謂歷史 block）。</p><p>本文<strong>不會</strong>提供 Hardhat 與其他相關套件的安裝指引，相關操作細節可以參考 LunDAO 其他教學文章。若您已知道如何使用 Hardhat 部屬 ERC-20 合約，則本文深度恰巧適合您。以下為筆者已測試能夠成功運行本文章步驟的軟硬體條件，請讀者參酌使用。</p><ul><li>Software<ul><li>Windows<ul><li>OS：Windows 10 Pro 21H1 (w/o WSL)</li><li>nodejs v14.17.4</li><li>yarn 1.22.17</li></ul></li><li>Linux<ul><li>OS：Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-1053-raspi aarch64)</li><li>其他同 Windows 軟體配置</li></ul></li></ul></li><li>Hardware<ul><li>基本上無限制，下列為經過測試可行的組合</li><li>Windows：Intel Core i7-10510U (16GB) with 4G LTE cellular hotspot</li><li>Linux：Raspberry Pi 4B (4GB) with 1Gbps network</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="重要必備條件">重要必備條件<a class="hash-link" href="#重要必備條件" title="Direct link to heading">​</a></h2><p>由於 mainnet forking 的運作過程需與 archive node 作互動；因此，<strong>你必需準備好 archive node</strong> 並將 Hardhat 連接上它。最直白地方式即透過 Geth、OpenEthereum 等工具自架節點<sup id="fnref-5"><a href="#fn-5" class="footnote-ref">5</a></sup>，或可使用市面上知名的數家 SaaS 節點供應商之服務<sup id="fnref-6"><a href="#fn-6" class="footnote-ref">6</a></sup>。本文為求過程輕鬆好學習，以下將搭配 Alchemy 提供的服務。</p><p>另外，由於 Hardhat Network 是 EVM-compatible blockchain，因此理論上任何 EVM-compatible chain 的歸檔節點皆有機會使用 mainnet forking，但實際上可能與 Ethereum mainnet 相比有所限制，筆者僅另外使用過 Polygon mainnet 亦可順利運作。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-1建置環境">Step 1：建置環境<a class="hash-link" href="#step-1建置環境" title="Direct link to heading">​</a></h2><p>目標：成功啟動 Hardhat Network</p><ol><li>新增一個空白資料夾「<code>hardhat_fork</code>」</li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ mkdir hardhat_fork</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd hardhat_fork</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>安裝必備的 JavaScript 套件<ul><li>為求所有讀者都能在第一次操作時成功完成，本文將所有套件已指定版本號安裝</li><li>作者建議讀者學會之後，以使用最新 stable version 為佳</li></ul></li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn init # 沒有想更動的部分，就按 Enter 鍵帶過即可</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add dotenv@16.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add hardhat@2.8.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add @nomiclabs/hardhat-waffle@2.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add @nomiclabs/hardhat-web3@2.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add @nomiclabs/hardhat-ethers@2.0.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add web3@1.7.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add ethers@5.5.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>啟動 Hardhat Network 初始化設定</li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn hardhat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn run v1.22.15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888                      888 888               888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888                      888 888               888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888                      888 888               888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8888888888  8888b.  888d888 .d88888 88888b.   8888b.  888888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888     &quot;88b 888P&quot;  d88&quot; 888 888 &quot;88b     &quot;88b 888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888 .d888888 888    888  888 888  888 .d888888 888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888 888  888 888    Y88b 888 888  888 888  888 Y88b.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888 &quot;Y888888 888     &quot;Y88888 888  888 &quot;Y888888  &quot;Y888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to Hardhat v2.8.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? What do you want to do? …</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Create a basic sample project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Create an advanced sample project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Create an advanced sample project that uses TypeScript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">▸ Create an empty hardhat.config.js # 請選擇這個選項，並按 Enter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Quit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hardhat.config.js  node_modules  package.json  yarn.lock</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="4"><li>你可以發現 <code>hardhat_fork</code> 資料夾底下多了一個名為 <code>hardhat.config.js</code> 的檔案；它就是用來調整 Hardhat Network 和其他 hardhat 套件運作模式的重要參數檔。</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-2調整-hardhatconfigjs">Step 2：調整 <code>hardhat.config.js</code><a class="hash-link" href="#step-2調整-hardhatconfigjs" title="Direct link to heading">​</a></h2><p>目標：設定進行 mainnet forking 所需的相關參數</p><ol><li>在 <code>hardhat_fork</code> 資料夾，新增一個空白檔案叫做 <code>.env</code>，並以文字編輯器將以下內容插入其中<ul><li>記得先前往 Alchemy 註冊帳號，並創立一個空白 app 專案（預設可存取 archive node）</li></ul></li></ol><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Mainnet = &quot;https://eth-mainnet.alchemyapi.io/v2/&lt;your_Alchemy_key&gt;&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>使用任何文字編輯器，對 <code>hardhat.config.js</code> 進行編輯，將檔案改成以下樣子（可以直接複製、貼上，取代全部檔案內容）</li></ol><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@nomiclabs/hardhat-waffle&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@nomiclabs/hardhat-web3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@nomiclabs/hardhat-ethers&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;dotenv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;height&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Print the current block height&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">taskArgs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> block_height </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBlockNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">The current block height is </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">block_height</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">networks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">hardhat</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">forking</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Mainnet</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">blockNumber</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14297759</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 高度 14297759 發生在 2022-03-01 00:00:18 (UTC+0)，選擇此數字方便後續解說</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>為什麼要這樣設定呢？<ul><li><code>task()</code> 的程式片段目的是創造能印出目前區塊高度的指令（以 Hardhat Network 分叉出來的主網來看），關於 task 的編寫方法詳見文末的延伸閱讀</li><li><code>network</code> 項目底下，我們設定 <code>hardhat</code> 網路的相關參數，包含 archive node 的存取網址與分叉高度</li><li>由於 <code>network</code> 項目底下可以同時設定多個不同的網路，以下為簡易範例，詳細辦法請參見文末延伸閱讀</li></ul></li></ol><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">solidity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">networks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">arbitrum</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Arbitrum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">accounts</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">PriKey0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">PriKey1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">hardhat</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-3使用自定義的-hardhat-task-height">Step 3：使用自定義的 Hardhat task <code>height</code><a class="hash-link" href="#step-3使用自定義的-hardhat-task-height" title="Direct link to heading">​</a></h2><p>目標：透過自定義的 <code>height</code> task 來確認 mainnet forking 可正常運作</p><ol><li>列出所有可用的 Hardhat task<ul><li><code>--network &quot;hardhat&quot;</code> 代表命令 Hardhat 使用 Hardhat Network</li><li>如果讀者在 <code>hardhat.config.js</code> 裡面設置其他網路，則可透過此參數隨時切換網路</li><li>我們可以發現到「<code>AVAILABLE TASKS</code>」出現了一行 <code>height Print the current block height</code> 文字，與稍早我們在 <code>hardhat.config.js</code> 撰寫的內容一致</li></ul></li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn hardhat --network &quot;hardhat&quot; help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn run v1.22.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hardhat version 2.8.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Usage: hardhat [GLOBAL OPTIONS] &lt;TASK&gt; [TASK OPTIONS]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GLOBAL OPTIONS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --config              A Hardhat config file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --emoji               Use emoji in messages.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --help                Shows this message, or a task&#x27;s help if its name is provided</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --max-memory          The maximum amount of memory that Hardhat can use.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --network             The network to connect to.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --show-stack-traces   Show stack traces.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --tsconfig            A TypeScript config file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --verbose             Enables Hardhat verbose logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --version             Shows hardhat&#x27;s version.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AVAILABLE TASKS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  check         Check whatever you need</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  clean         Clears the cache and deletes all artifacts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  compile       Compiles the entire project, building all artifacts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console       Opens a hardhat console</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  flatten       Flattens and prints contracts and their dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  height        Print the current block height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  help          Prints this message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  node          Starts a JSON-RPC server on top of Hardhat Network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  run           Runs a user-defined script after compiling the project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test          Runs mocha tests</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>運行 <code>height</code> 指令<ul><li>由於目前 Ethereum 的最新區塊高度必定不只 14297759，因此可見我們已成功創造一個全新的 mainnet forking 環境</li></ul></li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn hardhat --network &quot;hardhat&quot; height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn run v1.22.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The current block height is 14297759</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>利用 <code>node</code> 指令，開始運作 Hardhat Network 節點<ul><li><strong>請注意</strong>：這些地址與私鑰都由已知的 key derivation 過程<sup id="fnref-7"><a href="#fn-7" class="footnote-ref">7</a></sup>產生；換句話說，任何使用 Hardhat 的開發者皆知這些私鑰，因此<strong>切勿在公開網路將東西傳送進這些地址！</strong></li><li>前文已提過 Hardhat Network 預設提供 20 個各具 10000 ETH 的帳號供開發者自由使用</li><li>搭配我們現已學會的 mainnet forking 技巧，則可開始使用這些幾乎用不完的 ETH ，在自己的 local testnet 做各類開發</li></ul></li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn hardhat --network &quot;hardhat&quot; node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn run v1.22.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Started HTTP and WebSocket JSON-RPC server at http://127.0.0.1:8545/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accounts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">========</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: These accounts, and their private keys, are publicly known.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any funds sent to them on Mainnet or any other live network WILL BE LOST.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account #0: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266 (10000 ETH)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Key: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account #1: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8 (10000 ETH)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Key: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account #19: 0x8626f6940e2eb28930efb4cef49b2d1f2c9c1199 (10000 ETH)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Key: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: These accounts, and their private keys, are publicly known.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any funds sent to them on Mainnet or any other live network WILL BE LOST.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>本文到此已完成所有步驟，恭喜各位讀者已學會如何使用 Hardhat 進行 mainnet forking。另一篇<a href="/blog/hardhat-forking-2">文章</a>將操作簡單的範例，向有興趣的讀者展示 Hardhat Network 的有趣應用。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="related-resources">Related resources<a class="hash-link" href="#related-resources" title="Direct link to heading">​</a></h2><ul><li>Yarn<ul><li><a href="https://classic.yarnpkg.com/en/" target="_blank" rel="noopener noreferrer">https://classic.yarnpkg.com/en/</a></li></ul></li><li>Hardhat<ul><li>GitHub：<a href="https://github.com/NomicFoundation/hardhat" target="_blank" rel="noopener noreferrer">https://github.com/NomicFoundation/hardhat</a></li><li>Mainnet forking：<a href="https://hardhat.org/hardhat-network/guides/mainnet-forking.html" target="_blank" rel="noopener noreferrer">https://hardhat.org/hardhat-network/guides/mainnet-forking.html</a></li><li>Configuration：<a href="https://hardhat.org/config/" target="_blank" rel="noopener noreferrer">https://hardhat.org/config/</a></li><li>Hardhat Network Reference：<a href="https://hardhat.org/hardhat-network/reference/" target="_blank" rel="noopener noreferrer">https://hardhat.org/hardhat-network/reference/</a></li><li>Creating a task：<a href="https://hardhat.org/guides/create-task.html" target="_blank" rel="noopener noreferrer">https://hardhat.org/guides/create-task.html</a></li><li>Hardhat Runtime Environment (HRE)：<a href="https://hardhat.org/advanced/hardhat-runtime-environment.html" target="_blank" rel="noopener noreferrer">https://hardhat.org/advanced/hardhat-runtime-environment.html</a></li></ul></li><li>Alchemy<ul><li><a href="https://www.alchemy.com/" target="_blank" rel="noopener noreferrer">https://www.alchemy.com/</a></li></ul></li><li>Ethereum on ARM<ul><li><a href="https://ethereum-on-arm-documentation.readthedocs.io/en/latest/quick-guide/about-quick-start.html" target="_blank" rel="noopener noreferrer">https://ethereum-on-arm-documentation.readthedocs.io/en/latest/quick-guide/about-quick-start.html</a></li></ul></li><li>Wrapped Ether<ul><li><a href="https://weth.io/index.html" target="_blank" rel="noopener noreferrer">https://weth.io/index.html</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="further-reading">Further reading<a class="hash-link" href="#further-reading" title="Direct link to heading">​</a></h2><ul><li>Infura<ul><li><a href="https://infura.io/" target="_blank" rel="noopener noreferrer">https://infura.io/</a></li></ul></li><li>QuickNode<ul><li><a href="https://www.quicknode.com/" target="_blank" rel="noopener noreferrer">https://www.quicknode.com/</a></li></ul></li><li>Truffle<ul><li>Simulate Live Networks with Forked Sandboxes：<a href="https://trufflesuite.com/blog/sandbox-forking-with-truffle-teams/index.html" target="_blank" rel="noopener noreferrer">https://trufflesuite.com/blog/sandbox-forking-with-truffle-teams/index.html</a></li></ul></li></ul><div class="footnotes"><hr><ol><li id="fn-1">例如：Rinkeby、Goerli、Kintsugi 等<a href="#fnref-1" class="footnote-backref">↩</a></li><li id="fn-2">可能因不同 testnet 共識機制，而與主網略有差異，但是一般來說很罕見出現 Dapp 能夠運行於 testnet 卻無法運行於 mainnet，尤其所有網路的 EVM 實作細節均相同<a href="#fnref-2" class="footnote-backref">↩</a></li><li id="fn-3"><a href="https://hardhat.org/hardhat-network/guides/mainnet-forking.html#mainnet-forking" target="_blank" rel="noopener noreferrer">https://hardhat.org/hardhat-network/guides/mainnet-forking.html#mainnet-forking</a><a href="#fnref-3" class="footnote-backref">↩</a></li><li id="fn-5">透過樹梅派 4B 可以搭建歸檔節點，不以挖礦為目的來搭建歸檔節點非難事，只需要準備大容量的 SATA3 SSD 即可，詳細請參考文末的延伸閱讀 Ethereum on ARM<a href="#fnref-5" class="footnote-backref">↩</a></li><li id="fn-6">Infura、Alchemy、QuickNode 均有提供存取歸檔節點的服務，其中 Alchemy 在作者撰文時為免費服務。<a href="#fnref-6" class="footnote-backref">↩</a></li><li id="fn-7">有興趣的讀者請參見這個連結 <a href="https://hardhat.org/hardhat-network/reference/#accounts" target="_blank" rel="noopener noreferrer">https://hardhat.org/hardhat-network/reference/#accounts</a><a href="#fnref-7" class="footnote-backref">↩</a></li></ol></div></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/mainnet-fork">Mainnet Fork</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/mainnet-forking">Mainnet Forking</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/hardhat">Hardhat</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/nomic-labs">Nomic Labs</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/lun-dao/LunDAO/tree/main/blog/2022-03-23-hardhat-forking/hardhat-forking-1.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/diamond101"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« <!-- -->Diamond 101 (1)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/hardhat-forking-2"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Hardhat mainnet forking：主網分叉 (2)<!-- --> »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#背景知識與環境" class="table-of-contents__link toc-highlight">背景知識與環境</a></li><li><a href="#重要必備條件" class="table-of-contents__link toc-highlight">重要必備條件</a></li><li><a href="#step-1建置環境" class="table-of-contents__link toc-highlight">Step 1：建置環境</a></li><li><a href="#step-2調整-hardhatconfigjs" class="table-of-contents__link toc-highlight">Step 2：調整 <code>hardhat.config.js</code></a></li><li><a href="#step-3使用自定義的-hardhat-task-height" class="table-of-contents__link toc-highlight">Step 3：使用自定義的 Hardhat task <code>height</code></a></li><li><a href="#related-resources" class="table-of-contents__link toc-highlight">Related resources</a></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further reading</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">關於</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/lun-dao/LunDAO" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>關於 LunDAO<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/publish-guideline">投稿文章</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">閱讀文章</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/request-for-article">文章提案</a></li><li class="footer__item"><a href="https://github.com/lun-dao/LunDAO/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>社群貢獻指南<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">DAO治理</div><ul class="footer__items"><li class="footer__item"><a href="https://coordinape.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>貢獻投票 (Coordinape)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://snapshot.org/#/lundao.eth" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>治理投票 (Snapshot)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/treasury">社群金庫</a></li></ul></div><div class="col footer__col"><div class="footer__title">社群</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/lun-dao/LunDAO/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>討論區<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/9s3RQmajBu" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 LunDAO. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.67d47840.js"></script>
<script src="/assets/js/main.2d5310ba.js"></script>
</body>
</html>