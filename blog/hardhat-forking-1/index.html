<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="LunDAO RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="LunDAO Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-react-helmet="true">Hardhat mainnet forkingï¼šä¸»ç¶²åˆ†å‰ (1) | LunDAO</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://lundao.tech/blog/hardhat-forking-1"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Hardhat mainnet forkingï¼šä¸»ç¶²åˆ†å‰ (1) | LunDAO"><meta data-react-helmet="true" name="description" content="å¦‚ä½•åˆ©ç”¨ Hardhat é€²è¡Œä¸»ç¶²åˆ†å‰"><meta data-react-helmet="true" property="og:description" content="å¦‚ä½•åˆ©ç”¨ Hardhat é€²è¡Œä¸»ç¶²åˆ†å‰"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-03-23T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/a2468834"><meta data-react-helmet="true" property="article:tag" content="Mainnet Fork,Mainnet Forking,Hardhat,Nomic Labs"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://lundao.tech/blog/hardhat-forking-1"><link data-react-helmet="true" rel="alternate" href="https://lundao.tech/blog/hardhat-forking-1" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://lundao.tech/blog/hardhat-forking-1" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ba61c7d6.css">
<link rel="preload" href="/assets/js/runtime~main.67d47840.js" as="script">
<link rel="preload" href="/assets/js/main.2d5310ba.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">LunDAO</b></a><a class="navbar__item navbar__link" href="/docs/publish-guideline">é—œæ–¼</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">æ–‡ç« </a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lun-dao/LunDAO" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>DAO<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ğŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ğŸŒ</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/end-of-lundao">LunDAO çš„çµå°¾</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/crvusd">LLAMMA - crvUSD çš„æ–°æ¸…ç®—æ©Ÿåˆ¶</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/diamond101-4">Diamond 101 (4)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/diamond101-2">Diamond 101 (2)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/diamond101-3">Diamond 101 (3)</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Hardhat mainnet forkingï¼šä¸»ç¶²åˆ†å‰ (1)</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-03-23T00:00:00.000Z" itemprop="datePublished">March 23, 2022</time> Â· <!-- -->13 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/a2468834" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/a2468834.png" alt="Chuan-Chun Wang"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/a2468834" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Chuan-Chun Wang</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>æœ¬æ–‡ç« å°‡å±•ç¤ºæ€éº¼ä½¿ç”¨çŸ¥åé–‹ç™¼å·¥å…· Hardhat çš„ä¸»ç¶²åˆ†å‰ï¼ˆmainnet forkingï¼‰ï¼Œä»¤é–‹ç™¼è€…å¯ä»»æ„æŒ‡å®šæ¬²åˆ†å‰çš„å€å¡Šéˆé«˜åº¦ï¼Œä¸¦èˆ‡ Hardhat å…§å»ºçš„è‡ªå®šç¾© testnetï¼ˆHardhat Networkï¼‰çµåˆï¼Œäº«å—æœ€é«˜ä»¿çœŸåº¦ã€æœ€ç°¡ä¾¿çš„é–‹ç™¼ç’°å¢ƒã€‚</p><p>åœ¨ Ethereum é–‹ç™¼ Dapp å°‘ä¸äº†æ’°å¯«æ™ºèƒ½åˆç´„ï¼ˆsmart contractï¼‰ï¼›é™¤äº†ä½¿ç”¨ Go Ethereumï¼ˆGethï¼‰ã€OpenEthereum ç­‰å·¥å…·è‡ªå»ºä¸€æ¢ local testnetï¼Œä¸¦å°‡åˆç´„éƒ¨å±¬åœ¨ä¸Šé¢ä¹‹å¤–ï¼Œé‚„å¯å°‡åˆç´„éƒ¨å±¬åˆ°å„å¤§å…¬é–‹æ¸¬è©¦ç¶²ï¼ˆtestnetï¼‰<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>ã€‚ç„¶è€Œï¼Œé€™äº›æ–¹æ³•é›–ç„¶éƒ½ä½¿ç”¨èˆ‡ä¸»ç¶²ï¼ˆmainnetï¼‰å¹¾ä¹ç›¸åŒçš„<sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>ç¨‹å¼ç¢¼ç•¶ä½œ L1 åº•å±¤ï¼Œä½†æ˜¯èˆ‡ç›´æ¥éƒ¨å±¬åœ¨ mainnet æœ€å¤§çš„å·®ç•°å°±æ˜¯ï¼šä½ å¹¾ä¹ç„¡æ³•è®“ä½ çš„ Dapp èˆ‡å…¶ä»–çŸ¥ååˆç´„ã€DEX åšäº’å‹•ã€‚</p><p>DeFi ä¹‹æ‰€ä»¥åœ¨è¿‘å¹´å—åˆ°å…¨çƒçŸšç›®ï¼Œå…¶ä¸­ä¸€å€‹åŸå› è«éæ–¼å…¶é«˜åº¦çš„äº’æ“ä½œæ€§ï¼ˆinteroperabilityï¼‰ï¼›å„å€‹åˆç´„ä¹‹é–“å¯ä»¥é€éç¨‹å¼å‘¼å«ï¼Œè¼•é¬†åœ°èˆ‡å½¼æ­¤äº’å‹•ï¼Œé”æˆå‚³çµ±é‡‘èæ‰€ç„¡æ³•ä¼åŠçš„å·¨å¤§éˆæ´»èƒ½åŠ›ã€‚</p><p>ç„¶è€Œï¼Œå¦‚æœä½ æ­£åœ¨é–‹ç™¼çš„ Dapp/DeFi å°ˆæ¡ˆï¼Œç„¡æ³•åœ¨æ¥µåº¦ä»¿çœŸçš„ç’°å¢ƒç•¶ä¸­ï¼Œé€šéå®Œæ•´çš„æ¸¬è©¦å³è²¿ç„¶ä¸Šç·šï¼Œå‰‡æ­¤æœå‹™å°‡æš´éœ²æ–¼å·¨å¤§é¢¨éšªä¹‹ä¸‹ã€‚</p><p>éƒ¨å±¬åˆç´„æ–¼ (local) testnet ç•¶ä¸­ï¼Œç‚ºæ±‚æœ€ç²¾ç·»çš„æ¨¡æ“¬ç’°å¢ƒï¼Œä½ å°‡æœƒè€—è²»æ¥µå¤§å¿ƒåŠ›é€ä¸€è¤‡è£½æ‰€æœ‰ç¬¬ä¸‰æ–¹åˆç´„ã€DEX çš„ç¨‹å¼ç¢¼ï¼Œä¸¦é‡æ–°ä½ˆç½²æ–¼æ¨¡æ“¬ç’°å¢ƒç•¶ä¸­ï¼Œé€™å®Œå…¨ä¸æ˜¯ä¸€å€‹å¯è¡Œçš„æ–¹æ³•ã€‚</p><p>Hardhat çš„èªªæ˜æ–‡ä»¶æ˜¯é€™éº¼ä»‹ç´¹ mainnet forkingï¼š</p><blockquote><p>You can start an instance of Hardhat Network that forks mainnet. <strong>This means that it will simulate having the same state as mainnet</strong>, but it will work as a local development network. <sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup></p></blockquote><p>æœ¬æ–‡ç« å°‡å¸¶é ˜å„ä½è®€è€…ç†Ÿæ‚‰ mainnet forking çš„ä½¿ç”¨æ–¹æ³•ï¼Œä¸¦åœ¨å¦ä¸€ç¯‡æ–‡ç« ç•¶ä¸­èˆ‰å¹¾å€‹ä¾‹å­è®“è®€è€…èƒ½é«”æœƒ mainnet forking çš„æ–¹ä¾¿æ€§ï¼Œä»¥æœŸå„ä½è®€è€…éƒ½èƒ½å–„ç”¨æ­¤å·¥å…·ã€‚</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="èƒŒæ™¯çŸ¥è­˜èˆ‡ç’°å¢ƒ">èƒŒæ™¯çŸ¥è­˜èˆ‡ç’°å¢ƒ<a class="hash-link" href="#èƒŒæ™¯çŸ¥è­˜èˆ‡ç’°å¢ƒ" title="Direct link to heading">â€‹</a></h2><p>Mainnet forking èƒŒå¾Œçš„é‹ä½œæ©Ÿåˆ¶ï¼Œæ¦‚å¿µä¸Šå°±æ˜¯æ¨¡æ“¬ä¸€å€‹ä»¿é€  Ethereum mainnet çš„ local testnetï¼Œè®“é–‹ç™¼è€…èª¤ä»¥ç‚ºè‡ªå·±æ˜¯è·Ÿ mainnet äº’å‹•ã€‚</p><p>ç•¶é–‹ç™¼è€…å‘¼å«åˆç´„æˆ–ç™¼é€ tx æ™‚ï¼Œå¦‚æœè©²ã€Œä»¿é€ ç‰ˆã€local testnet æŸ¥ç„¡è³‡è¨Šï¼ˆè©²è³‡è¨Šå¯èƒ½æ˜¯ç´€éŒ„åœ¨æŸå€‹æ­·å² block ç•¶ä¸­ï¼‰ï¼Œå‰‡ Hardhat å¥—ä»¶è½‰å‘æ­¸æª”ç¯€é»ï¼ˆarchive nodeï¼‰è©¢å•è³‡è¨Šçš„å…§å®¹ï¼Œä¸¦å°‡å›å‚³çš„çµæœç¶“éé©ç•¶åŒ…è£å¾Œä¸Ÿçµ¦é–‹ç™¼è€…ã€‚å› æ­¤ï¼Œé–‹ç™¼è€…å¿…éœ€ä¸»å‹•æä¾›å…©å€‹æ¢ä»¶ï¼š(1) archive node (2) æŒ‡å®šçš„å€å¡Šé«˜åº¦ï¼ˆä»¥æ­¤é«˜åº¦ç‚ºåŸºæº–åŠƒåˆ†å‡ºä½•è¬‚æ­·å² blockï¼‰ã€‚</p><p>æœ¬æ–‡<strong>ä¸æœƒ</strong>æä¾› Hardhat èˆ‡å…¶ä»–ç›¸é—œå¥—ä»¶çš„å®‰è£æŒ‡å¼•ï¼Œç›¸é—œæ“ä½œç´°ç¯€å¯ä»¥åƒè€ƒ LunDAO å…¶ä»–æ•™å­¸æ–‡ç« ã€‚è‹¥æ‚¨å·²çŸ¥é“å¦‚ä½•ä½¿ç”¨ Hardhat éƒ¨å±¬ ERC-20 åˆç´„ï¼Œå‰‡æœ¬æ–‡æ·±åº¦æ°å·§é©åˆæ‚¨ã€‚ä»¥ä¸‹ç‚ºç­†è€…å·²æ¸¬è©¦èƒ½å¤ æˆåŠŸé‹è¡Œæœ¬æ–‡ç« æ­¥é©Ÿçš„è»Ÿç¡¬é«”æ¢ä»¶ï¼Œè«‹è®€è€…åƒé…Œä½¿ç”¨ã€‚</p><ul><li>Software<ul><li>Windows<ul><li>OSï¼šWindows 10 Pro 21H1 (w/o WSL)</li><li>nodejs v14.17.4</li><li>yarn 1.22.17</li></ul></li><li>Linux<ul><li>OSï¼šUbuntu 20.04.4 LTS (GNU/Linux 5.4.0-1053-raspi aarch64)</li><li>å…¶ä»–åŒ Windows è»Ÿé«”é…ç½®</li></ul></li></ul></li><li>Hardware<ul><li>åŸºæœ¬ä¸Šç„¡é™åˆ¶ï¼Œä¸‹åˆ—ç‚ºç¶“éæ¸¬è©¦å¯è¡Œçš„çµ„åˆ</li><li>Windowsï¼šIntel Core i7-10510U (16GB) with 4G LTE cellular hotspot</li><li>Linuxï¼šRaspberry Pi 4B (4GB) with 1Gbps network</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="é‡è¦å¿…å‚™æ¢ä»¶">é‡è¦å¿…å‚™æ¢ä»¶<a class="hash-link" href="#é‡è¦å¿…å‚™æ¢ä»¶" title="Direct link to heading">â€‹</a></h2><p>ç”±æ–¼ mainnet forking çš„é‹ä½œéç¨‹éœ€èˆ‡ archive node ä½œäº’å‹•ï¼›å› æ­¤ï¼Œ<strong>ä½ å¿…éœ€æº–å‚™å¥½ archive node</strong> ä¸¦å°‡ Hardhat é€£æ¥ä¸Šå®ƒã€‚æœ€ç›´ç™½åœ°æ–¹å¼å³é€é Gethã€OpenEthereum ç­‰å·¥å…·è‡ªæ¶ç¯€é»<sup id="fnref-5"><a href="#fn-5" class="footnote-ref">5</a></sup>ï¼Œæˆ–å¯ä½¿ç”¨å¸‚é¢ä¸ŠçŸ¥åçš„æ•¸å®¶ SaaS ç¯€é»ä¾›æ‡‰å•†ä¹‹æœå‹™<sup id="fnref-6"><a href="#fn-6" class="footnote-ref">6</a></sup>ã€‚æœ¬æ–‡ç‚ºæ±‚éç¨‹è¼•é¬†å¥½å­¸ç¿’ï¼Œä»¥ä¸‹å°‡æ­é… Alchemy æä¾›çš„æœå‹™ã€‚</p><p>å¦å¤–ï¼Œç”±æ–¼ Hardhat Network æ˜¯ EVM-compatible blockchainï¼Œå› æ­¤ç†è«–ä¸Šä»»ä½• EVM-compatible chain çš„æ­¸æª”ç¯€é»çš†æœ‰æ©Ÿæœƒä½¿ç”¨ mainnet forkingï¼Œä½†å¯¦éš›ä¸Šå¯èƒ½èˆ‡ Ethereum mainnet ç›¸æ¯”æœ‰æ‰€é™åˆ¶ï¼Œç­†è€…åƒ…å¦å¤–ä½¿ç”¨é Polygon mainnet äº¦å¯é †åˆ©é‹ä½œã€‚</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-1å»ºç½®ç’°å¢ƒ">Step 1ï¼šå»ºç½®ç’°å¢ƒ<a class="hash-link" href="#step-1å»ºç½®ç’°å¢ƒ" title="Direct link to heading">â€‹</a></h2><p>ç›®æ¨™ï¼šæˆåŠŸå•Ÿå‹• Hardhat Network</p><ol><li>æ–°å¢ä¸€å€‹ç©ºç™½è³‡æ–™å¤¾ã€Œ<code>hardhat_fork</code>ã€</li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ mkdir hardhat_fork</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd hardhat_fork</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>å®‰è£å¿…å‚™çš„ JavaScript å¥—ä»¶<ul><li>ç‚ºæ±‚æ‰€æœ‰è®€è€…éƒ½èƒ½åœ¨ç¬¬ä¸€æ¬¡æ“ä½œæ™‚æˆåŠŸå®Œæˆï¼Œæœ¬æ–‡å°‡æ‰€æœ‰å¥—ä»¶å·²æŒ‡å®šç‰ˆæœ¬è™Ÿå®‰è£</li><li>ä½œè€…å»ºè­°è®€è€…å­¸æœƒä¹‹å¾Œï¼Œä»¥ä½¿ç”¨æœ€æ–° stable version ç‚ºä½³</li></ul></li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn init # æ²’æœ‰æƒ³æ›´å‹•çš„éƒ¨åˆ†ï¼Œå°±æŒ‰ Enter éµå¸¶éå³å¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add dotenv@16.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add hardhat@2.8.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add @nomiclabs/hardhat-waffle@2.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add @nomiclabs/hardhat-web3@2.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add @nomiclabs/hardhat-ethers@2.0.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add web3@1.7.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn add ethers@5.5.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>å•Ÿå‹• Hardhat Network åˆå§‹åŒ–è¨­å®š</li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn hardhat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn run v1.22.15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888                      888 888               888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888                      888 888               888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888                      888 888               888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8888888888  8888b.  888d888 .d88888 88888b.   8888b.  888888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888     &quot;88b 888P&quot;  d88&quot; 888 888 &quot;88b     &quot;88b 888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888 .d888888 888    888  888 888  888 .d888888 888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888 888  888 888    Y88b 888 888  888 888  888 Y88b.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">888    888 &quot;Y888888 888     &quot;Y88888 888  888 &quot;Y888888  &quot;Y888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to Hardhat v2.8.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? What do you want to do? â€¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Create a basic sample project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Create an advanced sample project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Create an advanced sample project that uses TypeScript</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â–¸ Create an empty hardhat.config.js # è«‹é¸æ“‡é€™å€‹é¸é …ï¼Œä¸¦æŒ‰ Enter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Quit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hardhat.config.js  node_modules  package.json  yarn.lock</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="4"><li>ä½ å¯ä»¥ç™¼ç¾ <code>hardhat_fork</code> è³‡æ–™å¤¾åº•ä¸‹å¤šäº†ä¸€å€‹åç‚º <code>hardhat.config.js</code> çš„æª”æ¡ˆï¼›å®ƒå°±æ˜¯ç”¨ä¾†èª¿æ•´ Hardhat Network å’Œå…¶ä»– hardhat å¥—ä»¶é‹ä½œæ¨¡å¼çš„é‡è¦åƒæ•¸æª”ã€‚</li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-2èª¿æ•´-hardhatconfigjs">Step 2ï¼šèª¿æ•´ <code>hardhat.config.js</code><a class="hash-link" href="#step-2èª¿æ•´-hardhatconfigjs" title="Direct link to heading">â€‹</a></h2><p>ç›®æ¨™ï¼šè¨­å®šé€²è¡Œ mainnet forking æ‰€éœ€çš„ç›¸é—œåƒæ•¸</p><ol><li>åœ¨ <code>hardhat_fork</code> è³‡æ–™å¤¾ï¼Œæ–°å¢ä¸€å€‹ç©ºç™½æª”æ¡ˆå«åš <code>.env</code>ï¼Œä¸¦ä»¥æ–‡å­—ç·¨è¼¯å™¨å°‡ä»¥ä¸‹å…§å®¹æ’å…¥å…¶ä¸­<ul><li>è¨˜å¾—å…ˆå‰å¾€ Alchemy è¨»å†Šå¸³è™Ÿï¼Œä¸¦å‰µç«‹ä¸€å€‹ç©ºç™½ app å°ˆæ¡ˆï¼ˆé è¨­å¯å­˜å– archive nodeï¼‰</li></ul></li></ol><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Mainnet = &quot;https://eth-mainnet.alchemyapi.io/v2/&lt;your_Alchemy_key&gt;&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>ä½¿ç”¨ä»»ä½•æ–‡å­—ç·¨è¼¯å™¨ï¼Œå° <code>hardhat.config.js</code> é€²è¡Œç·¨è¼¯ï¼Œå°‡æª”æ¡ˆæ”¹æˆä»¥ä¸‹æ¨£å­ï¼ˆå¯ä»¥ç›´æ¥è¤‡è£½ã€è²¼ä¸Šï¼Œå–ä»£å…¨éƒ¨æª”æ¡ˆå…§å®¹ï¼‰</li></ol><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@nomiclabs/hardhat-waffle&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@nomiclabs/hardhat-web3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@nomiclabs/hardhat-ethers&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;dotenv&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;height&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Print the current block height&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">taskArgs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> block_height </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBlockNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">The current block height is </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">block_height</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">networks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">hardhat</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">forking</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Mainnet</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">blockNumber</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14297759</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// é«˜åº¦ 14297759 ç™¼ç”Ÿåœ¨ 2022-03-01 00:00:18 (UTC+0)ï¼Œé¸æ“‡æ­¤æ•¸å­—æ–¹ä¾¿å¾ŒçºŒè§£èªª</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>ç‚ºä»€éº¼è¦é€™æ¨£è¨­å®šå‘¢ï¼Ÿ<ul><li><code>task()</code> çš„ç¨‹å¼ç‰‡æ®µç›®çš„æ˜¯å‰µé€ èƒ½å°å‡ºç›®å‰å€å¡Šé«˜åº¦çš„æŒ‡ä»¤ï¼ˆä»¥ Hardhat Network åˆ†å‰å‡ºä¾†çš„ä¸»ç¶²ä¾†çœ‹ï¼‰ï¼Œé—œæ–¼ task çš„ç·¨å¯«æ–¹æ³•è©³è¦‹æ–‡æœ«çš„å»¶ä¼¸é–±è®€</li><li><code>network</code> é …ç›®åº•ä¸‹ï¼Œæˆ‘å€‘è¨­å®š <code>hardhat</code> ç¶²è·¯çš„ç›¸é—œåƒæ•¸ï¼ŒåŒ…å« archive node çš„å­˜å–ç¶²å€èˆ‡åˆ†å‰é«˜åº¦</li><li>ç”±æ–¼ <code>network</code> é …ç›®åº•ä¸‹å¯ä»¥åŒæ™‚è¨­å®šå¤šå€‹ä¸åŒçš„ç¶²è·¯ï¼Œä»¥ä¸‹ç‚ºç°¡æ˜“ç¯„ä¾‹ï¼Œè©³ç´°è¾¦æ³•è«‹åƒè¦‹æ–‡æœ«å»¶ä¼¸é–±è®€</li></ul></li></ol><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">solidity</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">networks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">arbitrum</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">url</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Arbitrum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">accounts</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">PriKey0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">PriKey1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">hardhat</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-3ä½¿ç”¨è‡ªå®šç¾©çš„-hardhat-task-height">Step 3ï¼šä½¿ç”¨è‡ªå®šç¾©çš„ Hardhat task <code>height</code><a class="hash-link" href="#step-3ä½¿ç”¨è‡ªå®šç¾©çš„-hardhat-task-height" title="Direct link to heading">â€‹</a></h2><p>ç›®æ¨™ï¼šé€éè‡ªå®šç¾©çš„ <code>height</code> task ä¾†ç¢ºèª mainnet forking å¯æ­£å¸¸é‹ä½œ</p><ol><li>åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ Hardhat task<ul><li><code>--network &quot;hardhat&quot;</code> ä»£è¡¨å‘½ä»¤ Hardhat ä½¿ç”¨ Hardhat Network</li><li>å¦‚æœè®€è€…åœ¨ <code>hardhat.config.js</code> è£¡é¢è¨­ç½®å…¶ä»–ç¶²è·¯ï¼Œå‰‡å¯é€éæ­¤åƒæ•¸éš¨æ™‚åˆ‡æ›ç¶²è·¯</li><li>æˆ‘å€‘å¯ä»¥ç™¼ç¾åˆ°ã€Œ<code>AVAILABLE TASKS</code>ã€å‡ºç¾äº†ä¸€è¡Œ <code>height Print the current block height</code> æ–‡å­—ï¼Œèˆ‡ç¨æ—©æˆ‘å€‘åœ¨ <code>hardhat.config.js</code> æ’°å¯«çš„å…§å®¹ä¸€è‡´</li></ul></li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn hardhat --network &quot;hardhat&quot; help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn run v1.22.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hardhat version 2.8.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Usage: hardhat [GLOBAL OPTIONS] &lt;TASK&gt; [TASK OPTIONS]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GLOBAL OPTIONS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --config              A Hardhat config file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --emoji               Use emoji in messages.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --help                Shows this message, or a task&#x27;s help if its name is provided</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --max-memory          The maximum amount of memory that Hardhat can use.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --network             The network to connect to.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --show-stack-traces   Show stack traces.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --tsconfig            A TypeScript config file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --verbose             Enables Hardhat verbose logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --version             Shows hardhat&#x27;s version.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AVAILABLE TASKS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  check         Check whatever you need</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  clean         Clears the cache and deletes all artifacts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  compile       Compiles the entire project, building all artifacts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  console       Opens a hardhat console</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  flatten       Flattens and prints contracts and their dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  height        Print the current block height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  help          Prints this message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  node          Starts a JSON-RPC server on top of Hardhat Network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  run           Runs a user-defined script after compiling the project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test          Runs mocha tests</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="2"><li>é‹è¡Œ <code>height</code> æŒ‡ä»¤<ul><li>ç”±æ–¼ç›®å‰ Ethereum çš„æœ€æ–°å€å¡Šé«˜åº¦å¿…å®šä¸åª 14297759ï¼Œå› æ­¤å¯è¦‹æˆ‘å€‘å·²æˆåŠŸå‰µé€ ä¸€å€‹å…¨æ–°çš„ mainnet forking ç’°å¢ƒ</li></ul></li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn hardhat --network &quot;hardhat&quot; height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn run v1.22.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The current block height is 14297759</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>åˆ©ç”¨ <code>node</code> æŒ‡ä»¤ï¼Œé–‹å§‹é‹ä½œ Hardhat Network ç¯€é»<ul><li><strong>è«‹æ³¨æ„</strong>ï¼šé€™äº›åœ°å€èˆ‡ç§é‘°éƒ½ç”±å·²çŸ¥çš„ key derivation éç¨‹<sup id="fnref-7"><a href="#fn-7" class="footnote-ref">7</a></sup>ç”¢ç”Ÿï¼›æ›å¥è©±èªªï¼Œä»»ä½•ä½¿ç”¨ Hardhat çš„é–‹ç™¼è€…çš†çŸ¥é€™äº›ç§é‘°ï¼Œå› æ­¤<strong>åˆ‡å‹¿åœ¨å…¬é–‹ç¶²è·¯å°‡æ±è¥¿å‚³é€é€²é€™äº›åœ°å€ï¼</strong></li><li>å‰æ–‡å·²æé Hardhat Network é è¨­æä¾› 20 å€‹å„å…· 10000 ETH çš„å¸³è™Ÿä¾›é–‹ç™¼è€…è‡ªç”±ä½¿ç”¨</li><li>æ­é…æˆ‘å€‘ç¾å·²å­¸æœƒçš„ mainnet forking æŠ€å·§ï¼Œå‰‡å¯é–‹å§‹ä½¿ç”¨é€™äº›å¹¾ä¹ç”¨ä¸å®Œçš„ ETH ï¼Œåœ¨è‡ªå·±çš„ local testnet åšå„é¡é–‹ç™¼</li></ul></li></ol><div class="codeBlockContainer_J+bg language-Shell theme-code-block"><div class="codeBlockContent_csEI Shell"><pre tabindex="0" class="prism-code language-Shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn hardhat --network &quot;hardhat&quot; node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yarn run v1.22.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Started HTTP and WebSocket JSON-RPC server at http://127.0.0.1:8545/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accounts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">========</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: These accounts, and their private keys, are publicly known.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any funds sent to them on Mainnet or any other live network WILL BE LOST.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account #0: 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266 (10000 ETH)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Key: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account #1: 0x70997970c51812dc3a010c7d01b50e0d17dc79c8 (10000 ETH)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Key: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account #19: 0x8626f6940e2eb28930efb4cef49b2d1f2c9c1199 (10000 ETH)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Key: ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: These accounts, and their private keys, are publicly known.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Any funds sent to them on Mainnet or any other live network WILL BE LOST.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æœ¬æ–‡åˆ°æ­¤å·²å®Œæˆæ‰€æœ‰æ­¥é©Ÿï¼Œæ­å–œå„ä½è®€è€…å·²å­¸æœƒå¦‚ä½•ä½¿ç”¨ Hardhat é€²è¡Œ mainnet forkingã€‚å¦ä¸€ç¯‡<a href="/blog/hardhat-forking-2">æ–‡ç« </a>å°‡æ“ä½œç°¡å–®çš„ç¯„ä¾‹ï¼Œå‘æœ‰èˆˆè¶£çš„è®€è€…å±•ç¤º Hardhat Network çš„æœ‰è¶£æ‡‰ç”¨ã€‚</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="related-resources">Related resources<a class="hash-link" href="#related-resources" title="Direct link to heading">â€‹</a></h2><ul><li>Yarn<ul><li><a href="https://classic.yarnpkg.com/en/" target="_blank" rel="noopener noreferrer">https://classic.yarnpkg.com/en/</a></li></ul></li><li>Hardhat<ul><li>GitHubï¼š<a href="https://github.com/NomicFoundation/hardhat" target="_blank" rel="noopener noreferrer">https://github.com/NomicFoundation/hardhat</a></li><li>Mainnet forkingï¼š<a href="https://hardhat.org/hardhat-network/guides/mainnet-forking.html" target="_blank" rel="noopener noreferrer">https://hardhat.org/hardhat-network/guides/mainnet-forking.html</a></li><li>Configurationï¼š<a href="https://hardhat.org/config/" target="_blank" rel="noopener noreferrer">https://hardhat.org/config/</a></li><li>Hardhat Network Referenceï¼š<a href="https://hardhat.org/hardhat-network/reference/" target="_blank" rel="noopener noreferrer">https://hardhat.org/hardhat-network/reference/</a></li><li>Creating a taskï¼š<a href="https://hardhat.org/guides/create-task.html" target="_blank" rel="noopener noreferrer">https://hardhat.org/guides/create-task.html</a></li><li>Hardhat Runtime Environment (HRE)ï¼š<a href="https://hardhat.org/advanced/hardhat-runtime-environment.html" target="_blank" rel="noopener noreferrer">https://hardhat.org/advanced/hardhat-runtime-environment.html</a></li></ul></li><li>Alchemy<ul><li><a href="https://www.alchemy.com/" target="_blank" rel="noopener noreferrer">https://www.alchemy.com/</a></li></ul></li><li>Ethereum on ARM<ul><li><a href="https://ethereum-on-arm-documentation.readthedocs.io/en/latest/quick-guide/about-quick-start.html" target="_blank" rel="noopener noreferrer">https://ethereum-on-arm-documentation.readthedocs.io/en/latest/quick-guide/about-quick-start.html</a></li></ul></li><li>Wrapped Ether<ul><li><a href="https://weth.io/index.html" target="_blank" rel="noopener noreferrer">https://weth.io/index.html</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="further-reading">Further reading<a class="hash-link" href="#further-reading" title="Direct link to heading">â€‹</a></h2><ul><li>Infura<ul><li><a href="https://infura.io/" target="_blank" rel="noopener noreferrer">https://infura.io/</a></li></ul></li><li>QuickNode<ul><li><a href="https://www.quicknode.com/" target="_blank" rel="noopener noreferrer">https://www.quicknode.com/</a></li></ul></li><li>Truffle<ul><li>Simulate Live Networks with Forked Sandboxesï¼š<a href="https://trufflesuite.com/blog/sandbox-forking-with-truffle-teams/index.html" target="_blank" rel="noopener noreferrer">https://trufflesuite.com/blog/sandbox-forking-with-truffle-teams/index.html</a></li></ul></li></ul><div class="footnotes"><hr><ol><li id="fn-1">ä¾‹å¦‚ï¼šRinkebyã€Goerliã€Kintsugi ç­‰<a href="#fnref-1" class="footnote-backref">â†©</a></li><li id="fn-2">å¯èƒ½å› ä¸åŒ testnet å…±è­˜æ©Ÿåˆ¶ï¼Œè€Œèˆ‡ä¸»ç¶²ç•¥æœ‰å·®ç•°ï¼Œä½†æ˜¯ä¸€èˆ¬ä¾†èªªå¾ˆç½•è¦‹å‡ºç¾ Dapp èƒ½å¤ é‹è¡Œæ–¼ testnet å»ç„¡æ³•é‹è¡Œæ–¼ mainnetï¼Œå°¤å…¶æ‰€æœ‰ç¶²è·¯çš„ EVM å¯¦ä½œç´°ç¯€å‡ç›¸åŒ<a href="#fnref-2" class="footnote-backref">â†©</a></li><li id="fn-3"><a href="https://hardhat.org/hardhat-network/guides/mainnet-forking.html#mainnet-forking" target="_blank" rel="noopener noreferrer">https://hardhat.org/hardhat-network/guides/mainnet-forking.html#mainnet-forking</a><a href="#fnref-3" class="footnote-backref">â†©</a></li><li id="fn-5">é€éæ¨¹æ¢…æ´¾ 4B å¯ä»¥æ­å»ºæ­¸æª”ç¯€é»ï¼Œä¸ä»¥æŒ–ç¤¦ç‚ºç›®çš„ä¾†æ­å»ºæ­¸æª”ç¯€é»éé›£äº‹ï¼Œåªéœ€è¦æº–å‚™å¤§å®¹é‡çš„ SATA3 SSD å³å¯ï¼Œè©³ç´°è«‹åƒè€ƒæ–‡æœ«çš„å»¶ä¼¸é–±è®€ Ethereum on ARM<a href="#fnref-5" class="footnote-backref">â†©</a></li><li id="fn-6">Infuraã€Alchemyã€QuickNode å‡æœ‰æä¾›å­˜å–æ­¸æª”ç¯€é»çš„æœå‹™ï¼Œå…¶ä¸­ Alchemy åœ¨ä½œè€…æ’°æ–‡æ™‚ç‚ºå…è²»æœå‹™ã€‚<a href="#fnref-6" class="footnote-backref">â†©</a></li><li id="fn-7">æœ‰èˆˆè¶£çš„è®€è€…è«‹åƒè¦‹é€™å€‹é€£çµ <a href="https://hardhat.org/hardhat-network/reference/#accounts" target="_blank" rel="noopener noreferrer">https://hardhat.org/hardhat-network/reference/#accounts</a><a href="#fnref-7" class="footnote-backref">â†©</a></li></ol></div></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/mainnet-fork">Mainnet Fork</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/mainnet-forking">Mainnet Forking</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/hardhat">Hardhat</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/nomic-labs">Nomic Labs</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/lun-dao/LunDAO/tree/main/blog/2022-03-23-hardhat-forking/hardhat-forking-1.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/diamond101"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« <!-- -->Diamond 101 (1)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/hardhat-forking-2"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Hardhat mainnet forkingï¼šä¸»ç¶²åˆ†å‰ (2)<!-- --> Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#èƒŒæ™¯çŸ¥è­˜èˆ‡ç’°å¢ƒ" class="table-of-contents__link toc-highlight">èƒŒæ™¯çŸ¥è­˜èˆ‡ç’°å¢ƒ</a></li><li><a href="#é‡è¦å¿…å‚™æ¢ä»¶" class="table-of-contents__link toc-highlight">é‡è¦å¿…å‚™æ¢ä»¶</a></li><li><a href="#step-1å»ºç½®ç’°å¢ƒ" class="table-of-contents__link toc-highlight">Step 1ï¼šå»ºç½®ç’°å¢ƒ</a></li><li><a href="#step-2èª¿æ•´-hardhatconfigjs" class="table-of-contents__link toc-highlight">Step 2ï¼šèª¿æ•´ <code>hardhat.config.js</code></a></li><li><a href="#step-3ä½¿ç”¨è‡ªå®šç¾©çš„-hardhat-task-height" class="table-of-contents__link toc-highlight">Step 3ï¼šä½¿ç”¨è‡ªå®šç¾©çš„ Hardhat task <code>height</code></a></li><li><a href="#related-resources" class="table-of-contents__link toc-highlight">Related resources</a></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further reading</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">é—œæ–¼</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/lun-dao/LunDAO" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>é—œæ–¼ LunDAO<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/publish-guideline">æŠ•ç¨¿æ–‡ç« </a></li><li class="footer__item"><a class="footer__link-item" href="/blog">é–±è®€æ–‡ç« </a></li><li class="footer__item"><a class="footer__link-item" href="/docs/request-for-article">æ–‡ç« ææ¡ˆ</a></li><li class="footer__item"><a href="https://github.com/lun-dao/LunDAO/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>ç¤¾ç¾¤è²¢ç»æŒ‡å—<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">DAOæ²»ç†</div><ul class="footer__items"><li class="footer__item"><a href="https://coordinape.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>è²¢ç»æŠ•ç¥¨ (Coordinape)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://snapshot.org/#/lundao.eth" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>æ²»ç†æŠ•ç¥¨ (Snapshot)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/treasury">ç¤¾ç¾¤é‡‘åº«</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾ç¾¤</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/lun-dao/LunDAO/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>è¨è«–å€<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/9s3RQmajBu" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 LunDAO. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.67d47840.js"></script>
<script src="/assets/js/main.2d5310ba.js"></script>
</body>
</html>